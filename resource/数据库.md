# 数据库

# mysql

## 1.事务的ACID和隔离性

### 1.ACID

原子性(Atomic)：事务中各项操作，要么全做要么全不做，任何一项操作的失败都会导致整个事务的失败；
一致性(Consistent)：事务结束后系统状态是一致的；
隔离性(Isolated)：并发执行的事务彼此无法看到对方的中间状态；
持久性(Durable)：事务完成后所做的改动都会被持久化，即使发生灾难性的失败。通过日志和同步备份可以在故障发生后重建数据。

### 2.隔离级别

![image-20220111222721921](C:\Users\zhang\AppData\Roaming\Typora\typora-user-images\image-20220111222721921.png)



## 2.索引设计原则

### 适合做索引

**1.频繁where的，经常group by 和 order by和经常distinct的**

**2.散列度高的**

### 全表选择度

select count(distinct address) / count(*) from shop;

### 不适合做索引

**1.数据量小的表**

**2.大量重复数据的列**

**3.经常更新的创建过多的索引**



## 3.数据库服务器调优

### 1.调优流程图

<img src="C:\Users\zhang\AppData\Roaming\Typora\typora-user-images\image-20220315141829729.png" alt="image-20220315141829729" style="zoom: 25%;" />

### 2.使用慢查询调优

SHOW [GLOBAL|SESSION] STATUS LIKE 'Slow_queries';//慢查询的次数

show variables like '%long_query_time%';                        //查询参数

1.开启慢查询日志、设置慢查询阈值





## 4.数据库设计的原则

1.主键一定要设置为递增，防止页面分裂和记录移动。

2.小表驱动大表



## 5.专有名词

1.FileSort 排序  文件排序

2.单路排序 （快）（fileSort算法）
从磁盘读取查询需要的 所有列 放在BUFFER，按照order by列在buffer对它们进行排序。

3.覆盖索引

一个索引包含满足查询结果的列。（简单说就是， 索引列+主键 包含 SELECT 到 FROM之间查询的列 。）

4.索引下推（ICP）

先把符合条件的非聚簇索引页里的数据收集起来，  减少回表次数，
